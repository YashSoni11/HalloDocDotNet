@using HalloDoc_DAL.ViewModels;
@model HalloDoc_DAL.AdminViewModels.ClientRequest;

@{
    Layout = "_Layout";
}


@{
    string[] colors = { "#74d36e", "#ffb545", "#75ccff", "#e9aee7" };
    string[] requestorType = { "Patient", "Family/Friend", "Concierge", "Business" };




    <partial name="_DashNavbar" />

    if(ViewData["RoleName"] == "Phy")
    {
        <partial name="_ProviderDashTabs" />

    }
    else if(ViewData["RoleName"] == "Adm")
    {
    <partial name="_Dashtabs" />
        
    }



    <div id="ViewCaseModalContainer">
    </div>

    <div class="container-fluid mt-3">
        <div class="row justify-content-center">


            <div class="d-flex col-xl-8 col-lg-9 col-md-10 col-sm-11 col-12 mb-3 justify-content-between">
                <div class="d-flex" style="align-items:center;">
                    <h2>New Request</h2>
                    <span class="mx-1 RequestorTypeHeading" style="background-color:@colors[Model.RequestTypeId-1]">@requestorType[Model.RequestTypeId-1]</span>
                </div>

                @if(ViewData["RoleName"] == "Phy")
                {
                    <a class="btn btn-outline-info text-info lightInfo-btn" asp-action="Dashboard" asp-controller="ProviderDashboard">
                        <i class="bi bi-chevron-left text-info lightInfo-btn "></i>Back
                    </a>

                }else if(ViewData["RoleName"] == "Adm")
                {
                <a class="btn btn-outline-info text-info lightInfo-btn" asp-action="Dashboard" asp-controller="Admindashboard">
                    <i class="bi bi-chevron-left text-info lightInfo-btn "></i>Back
                </a>
                    
                }
            </div>


            <div class="col-xl-8 col-lg-9 col-md-10 col-sm-11 col-12 ">


                <form asp-controller="Admindashboard" asp-action="PostViewRequest" asp-route-requestId="@Model.RequestId" method="post">


                    <div class="container-fluid formContainer mb-5">
                        <div class="row mt-3">
                            <h4 class="mt-3 mb-3">Patient Information </h4>
                            <p class="text-secondary mb-0">Confirmation Number</p>
                            <h4 class="text-info ">
                                @(Model.ConfirmationNumber == null ? "MD090977097" : Model.ConfirmationNumber)
                            </h4>
                            <div class="col-12 mt-3">
                                <div class="form-floating mb-3">
                                    <textarea asp-for="@Model.Notes" type="text" class="form-control" disabled id="floatingInput" style="height:10rem;"
                                              placeholder="name@example.com"></textarea>
                                    <label for="floatingInput">Patient Notes</label>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-3">
                            <h4 class="mb-3">Contact Information</h4>
                            <div class="col-xl-6 col-sm-6 col-12">
                                <div class="form-floating mb-3">
                                    <input asp-for="@Model.Firstname" type="text" class="form-control" disabled id="floatingInput"
                                           placeholder="name@example.com" />
                                    <label for="floatingInput">First Name</label>
                                </div>
                            </div>

                            <div class="col-xl-6 col-sm-6 col-12">
                                <div class="form-floating mb-3">
                                    <input asp-for="@Model.Lastname" type="text" class="form-control " disabled id="floatingInput"
                                           placeholder="name@example.com">
                                    <label for="floatingInput">Last Name</label>
                                </div>
                            </div>

                            <div class="col-xl-6 col-sm-6 col-12">
                                <div class="form-floating mb-3">
                                    <input value="@Model.Birthdate.ToString("dd-MM-yyyy")" type="text" class="form-control " disabled id="floatingInput"
                                           placeholder="name@example.com">
                                    <label for="floatingInput">Date Of Birth</label>
                                </div>
                            </div>


                            <div class="col-xl-4 col-sm-5 col-8">
                                <div class="form-floating mb-3 phoneInputDiv">
                                    <input asp-for="@Model.Phonenumber" style='height: 57px;' type="tel" id='phonInput' class="form-control tbDisabled"
                                           id="floatingInput">
                                    <label for="floatingInput"></label>
                                </div>
                            </div>

                            <div class="col-xl-2 col-sm-4 col-4 d-flex  align-content-center">
                                <div class="form-floating mb-3 d-flex justify-content-center align-content-center">
                                    <button type="button" class="btn btn-outline-info text-info lightInfo-btn " style="width:6rem;">
                                        <i id='themeIcon' class="bi bi-telephone text-info fs-3"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="col-xl-5 col-sm-5 col-12">
                                <div class="form-floating mb-3">
                                    <input asp-for="@Model.Email" type="email" class="form-control emailInp tbDisabled" id="floatingInput"
                                           placeholder="name@example.com" onblur="checkEmailAvailibility()">
                                    <label for="floatingInput">Email</label>
                                </div>
                            </div>


                        </div>

                        <div class="row mt-3">
                            <h4 class="mb-3">Location Information</h4>
                            <div class="col-xl-6 col-sm-6 col-12">
                                <div class="form-floating mb-3">
                                    <input asp-for="State" type="text" class="form-control" disabled id="street"
                                           placeholder="name@example.com">
                                    <label for="floatingInput">Region</label>
                                </div>
                            </div>
                            <div class="col-xl-4 col-sm-5 col-8">
                                <div class="form-floating mb-3">
                                    <input value="@Model.Street,@Model.City,@Model.State,@Model.Zipcode" type="text" class="form-control " disabled id="city"
                                           placeholder="name@example.com">
                                    <label for="floatingInput">Business Name/Address</label>
                                </div>
                            </div>

                            <div class="col-xl-2 col-sm-4 col-4 d-flex  align-content-center">
                                <div class="form-floating mb-3 d-flex justify-content-center align-content-center">
                                    <button type="button" class="btn btn-outline-info text-info lightInfo-btn " style="width:6rem;" onclick="showLocation()">
                                        <i id='themeIcon' class="bi bi-geo-alt text-info fs-3"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-xl-6 col-sm-6 col-12">
                                <div class="form-floating mb-3">
                                    <input type="text" class="form-control " disabled id="state"
                                           placeholder="name@example.com">
                                    <label for="floatingInput">#Room</label>
                                </div>
                            </div>

                        </div>

                        <div class="row justify-content-end p-3">
                            <div class="d-flex col-4 justify-content-end" style="column-gap: 1rem;">
                               
                                @if( ViewData["RoleName"] == "Adm" && Model.Status == 1)
                                {
                                    <button type="button" class="btn btn-info  text-white darkInfo-btn" onclick="GetAssginCasePopup(@Model.RequestId,'ViewCaseModalContainer')">
                                        <i class="bi bi-card-checklist show-icon">
                                        </i><span class="text-vanish">Assign</span>
                                    </button>
                                    
                                }

                                @if(ViewData["RoleName"] == "Adm")
                                {

                                    <a asp-action="GetRequestNotes" asp-controller="Admindashboard" asp-route-id="@Model.RequestId" type="button" class="btn btn-info  text-white darkInfo-btn editBtn">
                                        <i class="bi bi-sticky show-icon">
                                        </i><span class="text-vanish">ViewNotes</span>
                                    </a>
                                }else if(ViewData["RoleName"] == "Phy")
                                {
                                    <a asp-action="GetRequestNotes" asp-controller="ProviderDashBoard" asp-route-id="@Model.RequestId" type="button" class="btn btn-info  text-white darkInfo-btn editBtn">
                                        ViewNotes
                                    </a>

                                }


                                @if(ViewData["RoleName"] == "Adm")
                                {

                                    <button type="button" class="btn btn-info  text-white darkInfo-btn editBtn" onclick="editDetails()">
                                        <i class="bi bi-pencil show-icon">
                                        </i><span class="text-vanish">Edit</span>
                                    </button>
                                <button type="submit" class="btn btn-info  text-white darkInfo-btn editMode" style="display:none;" onclick="()">Save</button>
                                <button type="button" class="btn btn-outline-info text-info lightInfo-btn editMode" style="display:none;" onclick="cancleEdit()">
                                    Cancle Edit
                                </button>
                                @if(Model.Status == 1 || Model.Status == 8)
                                {
                                        <button type="button" onclick="GetCancleCase(@Model.RequestId,'ViewCaseModalContainer')" class="btn btn-danger  text-white darkInfo-btn">
                                            <i class="bi bi-x-lg show-icon">
                                            </i><span class="text-vanish">Cancle</span>
                                        </button>
                                    
                                }
                                }



                            </div>
                        </div>

                    </div>

                </form>







            </div>

        </div>
    </div>
}

@section Scripts{

    @{

        <partial name="_ValidationScriptsPartial" />
    }
}

<script>
    $(document).ready(function () {

        let prevId = localStorage.getItem("ActiveLink")

      let currEle =   document.getElementById(prevId)

      currEle.classList.add("active");

        $(".tbDisabled").attr("disabled", "true")



        toastr.remove();
        if ('@TempData["ShowPositiveNotification"]' != '') {

            toastr.success('@TempData["ShowPositiveNotification"]');
        }
        else if ('@TempData["ShowNegativeNotification"]' != '') {
            toastr.error('@TempData["ShowNegativeNotification"]')
        }
    })



</script>