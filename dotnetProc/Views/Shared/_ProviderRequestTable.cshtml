@model HalloDoc_DAL.ProviderViewModels.ProvideRequestTable;
@using HalloDoc_DAL.AdminViewModels;



@* public enum Status
        {
            Unassigned = 1,
            Unpaid,
            MDEnRoute,
            MDOnSite,
            Conclude,
            Cancelled,
            CancelledByPatient,
            Closed,
            Accepted,
            Clear,
        }
*@



@{

    <partial name="_encounterModal" />

    string[] colors = { "#74d36e", "#ffb545", "#75ccff", "#e9aee7" };
    string[] requestorType = { "Patient", "Family/Friend", "Concierge", "Business" };
    string[] status = { "", "New", "Unpaid", "Active", "Active", "Conclude", "Conclude", "Conclude", "Toclose", "Pending", "" };


    <div class="row justify-content-between">

        <div class="col-xl-5 col-lg-5 col-md-12 col-12  align-content-center">
            <div class="container-fluid">
                <div class="row">

                    <div class="col-xl-5 col-lg-5 col-md-5 col-sm-12">

                        <div id="iuu" class="d-flex form-floating mb-3 bg-transparent" style="border:1px solid #d7d7d7; border-radius: 4px;">
                            <input value="" type="search" class="form-control  bg-transparent border-0 emailInput " id="searchinp"
                                   placeholder="name@example.com">
                            <label id="userLabel" for="searchinp">Search Patient</label>
                            <span class="" style="align-self:center;" id="userLabelIcon" onclick="GetRequestorTypeWiseProviderRequests('1',@Model.TotalPages,false,'@Model.RequestType')"><i class=' bi bi-search' style="color: var( --pi-label-color);"></i></span>

                        </div>

                    </div>
                   

                </div>

            </div>


        </div>

        <div class="col-xl-7 col-lg-7 col-md-12 col-12 d-flex justify-content-evenly  mt-md-3 mt-3" style="align-items:center;">

            <button id="ReqType-Heading0" class="btn  text-vanish ReqType-Heading" style="color:var(--pi-label-color);" onclick="GetFiltteredRequests('0')">All</button>
            <button id="ReqType-Heading1" onclick="GetRequestorTypeWiseProviderRequests('1',@Model.TotalPages,false,'1')" class="btn ReqType-Heading"> <i class="bi bi-circle-fill text-success"></i> Patient</button>
            <button id="ReqType-Heading2" onclick="GetRequestorTypeWiseProviderRequests('1',@Model.TotalPages,false,'2')" class="btn ReqType-Heading"> <i class="bi bi-circle-fill text-warning"></i> Family/Freind</button>
            <button id="ReqType-Heading3" onclick="GetRequestorTypeWiseProviderRequests('1',@Model.TotalPages,false,'3')" class="btn ReqType-Heading"> <i class="bi bi-circle-fill text-primary"></i> Concierge</button>
            <button id="ReqType-Heading4" onclick="GetRequestorTypeWiseProviderRequests('1',@Model.TotalPages,false,'4')" class="btn ReqType-Heading"> <i class="bi bi-circle-fill" style="color:pink;"></i> Business</button>

        </div>






    </div>

    <div class="row table-responsive" style="justify-content:center">



        @if (Model.Requests.Count != 0)
        {
            int j = 1;
            <table class="table ReqtableContainer">
                <thead>
                    <tr style="background-color:#f1f1f1;">
                        <th class="reqtableHeader" scope="col">Name</th>   
                        <th class="reqtableHeader" scope="col">Phone</th>
                        <th class="reqtableHeader" scope="col">Address</th>
                        <th class="reqtableHeader" scope="col">Status</th>
                        <th class="reqtableHeader" scope="col">Chat With</th>
                        <th class="reqtableHeader" scope="col">Action</th>
                    </tr>
                </thead>
                <tbody class="reqtableBody">

                    @foreach (DashboardRequests dr in Model.Requests)
                    {




                        <tr class="align-middle" style="background-color:@colors[dr.Requesttype-1] !important;color:white;">
                            <th class="align-middle" scope="row">@dr.Username</th>

                            <td class="align-middle">

                                <div class="phone-col"><i class="bi bi-telephone"></i><div>@dr.Phone</div></div><div>(Patient)</div>

                                @{
                                    if (dr.RequestorPhone != null)
                                    {
                                        <div class="phone-col"><i class="bi bi-telephone"></i><div>@dr.RequestorPhone</div></div>

                                        <div>(@requestorType[dr.Requesttype-1])</div>

                                    }
                                }

                            </td>
                            <td class="align-middle">@dr.Address </td>
                            <td class="align-middle">
                             
                                @if(dr.status == 4 && dr.CallType == 1)
                                {
                                    <form method="post" asp-action="PostHouseCallAction" asp-controller="ProviderDashboard" asp-route-id="@dr.Requestid">
                                    <button type="submit" class="btn btn-info  text-white darkInfo-btn">House Call</button>
                                    </form>

                                }

                            </td>
                            
                            <td class="align-middle">
                                <button type="button" class="btn bg-transparent action-btn "><i class="bi bi-person mx-1"></i> Provider</button>
                            </td>

                            <td class="align-middle">
                                <div class="dropdown">
                                    <button class="btn bg-transparent action-btn" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="bi bi-person mx-1"></i> Action
                                    </button>
                                    <ul class="dropdown-menu" style="background:var(--pi-form-back-color);">

                                        @{
                                            if (status[dr.status] == "New")
                                            {
                                                <li>
                                                    <form method="post" asp-action="AcceptRequest" asp-controller="ProviderDashboard" asp-route-requestId="@dr.Requestid">
                                                    
                                                    
                                                    <button type="submit" class="dropdown-item" style="var(--pi-label-color);">
                                                        <i class="bi bi-card-checklist mx-1">
                                                        </i> Accept 
                                                    </button>
                                                    </form>
                                                </li>
                                            }
                                      
                                            if (status[dr.status] == "New" || status[dr.status] == "Pending" || status[dr.status] == "Active" || status[dr.status] == "Conclude")
                                            {
                                                <li><a class=" btn dropdown-item" style="color:var(--pi-label-color)" asp-action="ViewRequest" asp-route-requestid="@dr.Requestid" asp-controller="ProviderDashboard"><i class="bi bi-eye mx-1"></i>View Case</a></li>
                                            }
                                            if (status[dr.status] == "New" || status[dr.status] == "Pending" || status[dr.status] == "Active" || status[dr.status] == "Conclude")
                                            {
                                                <li><a class="dropdown-item" style="color:var(--pi-label-color)" asp-action="GetRequestNotes" asp-controller="ProviderDashboard" asp-route-id="@dr.Requestid"><i class="bi bi-journal-text mx-1"></i>View Notes</a></li>
                                            }
                                       
                                            if (status[dr.status] == "Pending")
                                            {
                                                <li><button class="dropdown-item" style="color:var(--pi-label-color)" onclick="GetTransferAdminModalView(@dr.Requestid)"><i class="bi bi-journal-arrow-up mx-1"></i>Transfer</button></li>
                                            }
                                            if (status[dr.status] == "Pending")
                                            {
                                                <li><button class="dropdown-item" style="color:var(--pi-label-color)" onclick="GetSendAgreementView(@dr.Requestid,'DashBoardModalPopUp')"><i class="bi bi-journal-check mx-1"></i>Send Aggrement</button></li>
                                            }
                                          
                                            if (status[dr.status] == "Pending" || status[dr.status] == "Active" || status[dr.status] == "Conclude")
                                            {
                                                <li><a class="dropdown-item" style="color:var(--pi-label-color)" asp-action="ViewUploads" asp-route-id="@dr.Requestid" asp-controller="ProviderDashboard"><i class="bi bi-journal-text mx-1"></i>View Uploads</a></li>
                                            }
                                            if (status[dr.status] == "Active")
                                            {
                                                <li><a class="dropdown-item" style="color:var(--pi-label-color)" asp-action="SendOrder" asp-route-id="@dr.Requestid" asp-controller="ProviderDashboard"><i class="bi bi-file-earmark mx-1"></i>Orders</a></li>
                                            }
                                            if (status[dr.status] == "Active" || status[dr.status] == "Conclude")
                                            {

                                                <li><button class="dropdown-item" style="color:var(--pi-label-color)" onclick="GetEncounterCaseView(@dr.Requestid,'EncounterCaseModal',false)"><i class="bi bi-file-earmark-text mx-1"></i>Encounter</button></li>
                                            }
                                            if (status[dr.status] == "Conclude")
                                            {
                                                <li><a asp-action="ConcludeCareView" asp-controller="ProviderDashboard" asp-route-id="@dr.Requestid" class="dropdown-item" style="color:var(--pi-label-color)" ><i class="bi bi-file-earmark-text mx-1"></i>Conclude Care</a></li>
                                            }
                                            
                                        }











                                    </ul>
                                </div>
                            </td>
                        </tr>
                        j++;
                    }

                </tbody>
            </table>



            int i = 1;
            <div class=" DashboardAccordion accordion" id="accordionExample mt-3">

                @foreach (DashboardRequests dr in Model.Requests)
                {

                    <div class="accordion-item" style="background:var(--pi-form-back-color);">
                        <h2 class="accordion-header" id="heading@(i)">
                            <button class="accordion-button container-fluid" type="button" style="background:var(--accordian-btn-color);color:var(--pi-label-color);" data-bs-toggle="collapse" data-bs-target="#collapse@(i)" aria-expanded="true" aria-controls="collapse@(i)">
                                <div class="row">

                                    <div class="col-8">
                                        <div>@dr.Username</div>

                                        <div>@dr.Address</div>
                                    </div>
                                    <div class="col-4">
                                        <h5 class="ReqType-Heading"> <i class="bi bi-circle-fill" style="color:@colors[dr.Requesttype-1]"></i> @requestorType[dr.Requesttype-1]</h5>
                                    </div>

                                </div>

                            </button>
                        </h2>
                        <div id="collapse@(i)" class="accordion-collapse collapse show" aria-labelledby="heading@(i)" data-bs-parent="#accordionExample">
                            <div class="accordion-body container-fluid">

                                <div class="row">
                                    <div class="col-12 d-flex justify-content-end">

                                        <div class="linkTypeBtn" style="background-color:#f7e7ff;color:#990df0;border:1px solid #990df0;border-radius:10px;width:10rem;">
                                            <a class=" btn" asp-action="ViewRequest" asp-route-requestid="@dr.Requestid" asp-controller="ProviderDashboard">View Case</a>
                                        </div>

                                    </div>
                                </div>

                                <div class="row">

                                    <div class="col-12">

                                        <div class="d-flex align-content-center mt-2">
                                            <span class="AccordianIcons mx-1"><i class="bi bi-telephone mx-1"></i></span>  <h6 class="mt-0">Email: @(dr.Email != null ? dr.Email : "Not Available")</h6>
                                        </div>

                                        <div class="d-flex align-content-center mt-2">
                                            <span class="AccordianIcons mx-1"><i class="bi bi-telephone mx-1"></i></span>  <h6 class="mt-0">Patient: @(dr.Phone != null ? dr.Phone : "Not Available")</h6>
                                        </div>
                               
                                        <div class="d-flex align-content-center mt-2">
                                            <span class="AccordianIcons mx-1"><i class="bi bi-calendar mx-1"></i></span>  <h6 class="mt-0">Date of Service: </h6>
                                        </div>
                                        <div class="d-flex align-content-center mt-2">
                                            <span class="AccordianIcons mx-1"><i class="bi bi-file-medical mx-1"></i></span>  <h6 class="mt-0">Physician:@(dr.PhysicianName != null ? dr.PhysicianName : "Not Available") </h6>
                                        </div>
                                       


                                    </div>

                                </div>

                                <div class="row mt-3 gy-3">
                                    @{

                                        if (status[dr.status] == "New")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn ">
                                                    <form method="post" asp-action="AcceptRequest" asp-controller="ProviderDashboard" asp-route-requestId="@dr.Requestid">


                                                    <button type="submit" class="btn text-white" style="font-size:12px;" asp-action="GetRequestNotes" asp-controller="ProviderDashboard" asp-route-id="@dr.Requestid">Accept</button>
                                                    
                                                    </form>
                                                </div>

                                            </div>

                                        }
                                        if (status[dr.status] == "New" || status[dr.status] == "Pending" || status[dr.status] == "Active" || status[dr.status] == "Conclude")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn ">
                                                    <a class="btn text-white" style="font-size:12px;" asp-action="GetRequestNotes" asp-controller="ProviderDashboard" asp-route-id="@dr.Requestid">View Notes</a>
                                                </div>

                                            </div>

                                        }
                                        if (status[dr.status] == "Pending")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn " style="background:#0099f3;">
                                                    <button class="btn text-white" style="font-size:12px;" onclick="GetTransferAdminModalView(@dr.Requestid,'DashBoardModalPopUp')">Transfer</button>
                                                </div>

                                            </div>

                                        }
                                        if (status[dr.status] == "Pending")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn" style="background:#dba50c;">
                                                    <button class="btn text-white" style="font-size:12px;" onclick="GetSendAgreementView(@dr.Requestid,'DashBoardModalPopUp')">Send Aggrement</button>
                                                </div>

                                            </div>

                                        }
                                 
                                        if (status[dr.status] == "Pending" || status[dr.status] == "Active" || status[dr.status] == "Conclude")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn">
                                                    <a class="btn text-white" style="font-size:12px;" asp-action="ViewUploads" asp-route-id="@dr.Requestid" asp-controller="ProviderDashboard">View Uploads</a>
                                                </div>

                                            </div>

                                        }
                                        if (status[dr.status] == "Active" || status[dr.status] == "Conclude")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn" style="background:#dba50c;">
                                                    <a class="btn text-white" style="font-size:12px;" asp-action="SendOrder" asp-route-id="@dr.Requestid" asp-controller="ProviderDashboard">Orders</a>
                                                </div>

                                            </div>

                                        }
                                        if (status[dr.status] == "Active")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn" style="background:#0dcaf0;">
                                                    <form method="post" asp-action="PostHouseCallAction" asp-controller="ProviderDashboard" asp-route-id="@dr.Requestid">
                                                        <button type="submit" class="btn text-white">House Call</button>
                                                    </form>
                                                </div>

                                            </div>

                                        }
                                        if (status[dr.status] == "Active" || status[dr.status] == "Conclude")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn ">
                                                    <button class="btn text-white" style="font-size:12px;" onclick="GetEncounterCaseView(@dr.Requestid,'EncounterCaseModal',false)">Encounter</button>
                                                </div>

                                            </div>

                                        }
                                        if ( status[dr.status] == "Conclude")
                                        {
                                            <div class="col-6">

                                                <div class="linkTypeBtn" style="background:#dba50c;">
                                                    <a class="btn text-white" style="font-size:12px;" asp-action="ConcludeCareView" asp-controller="ProviderDashboard" asp-route-id="@dr.Requestid">Conclude Care</a>
                                                </div>

                                            </div>

                                        }
                                      
                                    }


                                </div>

                                <div class="row mt-3">

                                    <div class="col-12 d-flex justify-content-end" style="align-items:center;">
                                        <span class="mx-1" style="color:var(--pi-label-color);">Chat With:</span>
                                        <a href="#" class="btn p-0">
                                            <div class="linkTypeBtn mx-1" style="background-color:var(--pi-form-back-color);color:#0dcaf0;border:1px solid #0dcaf0;border-radius:10px;width:7rem;">
                                                <i class="bi bi-person fs-4"></i>  Patient
                                            </div>
                                        </a>
                                        <a href="#" class="btn p-0">
                                            <div class="linkTypeBtn" style="background-color:var(--pi-form-back-color);color:#0dcaf0;border:1px solid #0dcaf0;border-radius:10px;width:7rem;">
                                                <i class="bi bi-file-medical fs-4"></i>  Provider
                                            </div>
                                        </a>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>

                    i++;




                }
            </div>

        }
        else
        {

            <h4 class="alert alert-info fs-3  d-flex" role="alert" style="width:40%;margin-top:7rem;justify-content:center;">
                No Requests Available For This!
            </h4>
        }
    </div>



    <div class="row">
        <nav aria-label="Page navigation example mt-3">
            <ul class="pagination justify-content-end PageNumbers" style="column-gap:1rem;">
                <li class="page-item" onclick="GetRequestorTypeWiseProviderRequests(@Model.currentPage-1,@Model.TotalPages,true,'@Model.RequestType')" style="cursor:pointer"><i class="bi bi-chevron-left"></i></li>
                <li class="page-item text-white" style="padding-left: 1rem;padding-right: 1rem;background-color:#0dcaf0;cursor:pointer;">@Model.currentPage</li>
                <li class="page-item" onclick="GetRequestorTypeWiseProviderRequests(@Model.currentPage+1,@Model.TotalPages,true,'@Model.RequestType')" style="cursor:pointer;"><i class="bi bi-chevron-right"></i></li>
            </ul>
        </nav>

    </div>
}


<script>





</script>